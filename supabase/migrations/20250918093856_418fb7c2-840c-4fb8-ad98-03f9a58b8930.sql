-- إضافة عمود category إلى جدول room_questions
ALTER TABLE public.room_questions ADD COLUMN IF NOT EXISTS category text;

-- إدراج أسئلة افتراضية فوراً لحل المشكلة
INSERT INTO public.questions (question_text, options, correct_answer, category) VALUES 
('ما هي عاصمة المملكة العربية السعودية؟', '["الرياض", "جدة", "الدمام", "مكة المكرمة"]', 0, 'جغرافيا'),
('كم عدد أركان الإسلام؟', '["4", "5", "6", "7"]', 1, 'ديانات'),
('من هو مؤسس شركة آبل؟', '["بيل جيتس", "ستيف جوبز", "مارك زوكربيرغ", "إيلون ماسك"]', 1, 'تكنولوجيا'),
('ما هو أكبر كوكب في النظام الشمسي؟', '["الأرض", "المشتري", "زحل", "نبتون"]', 1, 'علوم'),
('في أي عام تم تأسيس المملكة العربية السعودية؟', '["1930", "1932", "1935", "1940"]', 1, 'تاريخ'),
('ما هي أطول سورة في القرآن الكريم؟', '["البقرة", "آل عمران", "النساء", "المائدة"]', 0, 'ديانات'),
('كم عدد قارات العالم؟', '["5", "6", "7", "8"]', 2, 'جغرافيا'),
('من هو مؤلف رواية "مدن الملح"؟', '["عبد الرحمن منيف", "نجيب محفوظ", "غازي القصيبي", "تركي الحمد"]', 0, 'أدب'),
('ما هي وحدة قياس الكتلة في النظام الدولي؟', '["الجرام", "الكيلوجرام", "الطن", "الرطل"]', 1, 'علوم'),
('كم عدد أيام السنة الكبيسة؟', '["365", "366", "367", "364"]', 1, 'عامة'),
('ما هي عملة دولة الإمارات العربية المتحدة؟', '["الريال", "الدينار", "الدرهم", "الجنيه"]', 2, 'اقتصاد'),
('من هو أول رائد فضاء عربي؟', '["سلطان بن سلمان", "هزاع المنصوري", "أحمد فارس", "محمد فارس"]', 0, 'علوم'),
('في أي قارة تقع دولة البرازيل؟', '["آسيا", "أفريقيا", "أمريكا الجنوبية", "أوروبا"]', 2, 'جغرافيا'),
('كم عدد بطولات كأس العالم التي فازت بها منتخب البرازيل؟', '["4", "5", "6", "3"]', 1, 'رياضة'),
('ما هو أسرع حيوان بري في العالم؟', '["الأسد", "الفهد", "النمر", "الذئب"]', 1, 'طبيعة'),
('ما هي أكبر دولة في العالم من حيث المساحة؟', '["الصين", "كندا", "روسيا", "أمريكا"]', 2, 'جغرافيا'),
('من هو مخترع المصباح الكهربائي؟', '["نيكولا تسلا", "توماس إديسون", "ألكسندر بيل", "بنجامين فرانكلين"]', 1, 'تكنولوجيا'),
('كم عدد العظام في جسم الإنسان البالغ؟', '["200", "206", "210", "215"]', 1, 'طب'),
('ما هو الغاز الأكثر وفرة في الغلاف الجوي؟', '["الأكسجين", "النيتروجين", "ثاني أكسيد الكربون", "الهيليوم"]', 1, 'علوم'),
('في أي مدينة يوجد برج إيفل؟', '["لندن", "باريس", "روما", "برلين"]', 1, 'جغرافيا');

-- إدراج نفس الأسئلة في جدول الاستخدام العالمي
INSERT INTO public.global_question_usage (question_text, question_hash, usage_count) 
SELECT 
    question_text, 
    encode(digest(lower(trim(question_text)), 'sha256'), 'hex') as question_hash,
    1 as usage_count
FROM public.questions 
WHERE id IN (SELECT id FROM public.questions ORDER BY created_at DESC LIMIT 20);